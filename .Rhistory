fit$gcv
plot(fit$gcv)
plot(1:100,fit$gcv)
plot(1:100,fit$gcv,type="l")
c<-1
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(1:100,fit$gcv,type="l")
fit$gcv
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
fit$c
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
fit$c
?plot
?xlim
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit)
plot(fit,xlim=c(0,10))
plot(fit,xlim=c(0,20))
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
plot(x,y,type="l")
fit<-css(y,x)
plot(fit,xlim=c(0,20))
plot(fit)
plot(fit,xlim=c(0,10))
U<-matrix(rnorm(100),ncol=1)
fit<-css(y,x,U)
fit
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
U<-matrix(rnorm(100),ncol=1)
fit<-css(y,x,U)
fit
plot(fit,xlim=c(0,10))
fit$c
summary(fit)
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
U<-matrix(rnorm(100),ncol=1)
fit<-css(y,x,U)
fit
plot(fit,xlim=c(0,10))
summary(fit)
library(CubicSmoothingSplines)
x<-seq(1,10,length=100)
y<-0.5+1.5*x+0.1*x^2+rnorm(100)
U<-matrix(rnorm(100),ncol=1)
fit<-css(y,x,U)
plot(fit,xlim=c(0,10))
summary(fit)
fit<-css(y,x)
plot(fit,xlim=c(0,10))
summary(fit)
library(CubicSmoothingSplines)
?list
vector("list",5)
SS<-vector("list",5)
SS
ss[[5]]<-5
SS[[5]]<-5
SS
?diag
ff<-NULL
ff1<-2
c(ff,ff1)
C.Omega.D<-rbind(C.Omega.D,cbind(0,diag(c[j]-1))%*%Omegahat[ca:cb,])
library(CubicSmoothingSplines)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
setwd("~/Dropbox/Work-files/Papers/Manuscripts/Rao/R")
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
n<-nrow(sellu)
p<-ncol(sellu)
sellu
sellu$puul
sellu$era
dim(sellu)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
Y<-as.matrix(sellu[sellu$puul==1,8:32])
dim(sellu)
Y<-as.matrix(sellu[sellu$puul==1,8:31])
Y
sellu
sellu
Y<-sellu[sellu$puul==1,8:31]
Y
summary(Y)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
dim(sellu)
Y<-sellu[sellu$puul==1,8:31]
summary(Y)
Y<-as.matrix(Y)
apply(Y,2,sum)
gg<-function(x)
{
sum(is.na(x))
}
apply(Y,2,gg)
gg<-function(x)
{
sum(is.na(x))
}
apply(sellu,2,gg)
apply(sellu[sellu$puul==1,],2,gg)
sellu<-sellu[sellu$puul==1,]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
Y<-sellu[,8:31]
Y<-as.matrix(Y)
dim(Y)
sellu$bright
sellu$visc
sellu$ph
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
sellu$bright
sellu$ph
sellu$elcond
median(sellu$elcond)
grp<-rep(0,length(sellu$elcond))
length(grp)
dim(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
?plot
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
plot(fit)
summary(fit)
fit<-gcss(Y[1:6,],grp=grp,t=t)
plot(fit)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-mgcss(Y,s,grp=grp,t=t)
summary(fit)
fit<-gcss(Y[1:6,],grp=grp,t=t)
plot(fit)
fit<-gcss(Y[1:6,],grp=grp,t=t)
plot(fit)
fit<-mgcss(Y,s,grp=grp,t=t)
fit<-gcss(Y[1:6,],grp=grp,t=t)
plot(fit)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
fit<-gcss(Y[1:6,],grp=grp,t=t)
plot(fit)
plot(fit)
fit<-gcss(Y[7:12,],grp=grp,t=t)
plot(fit)
plot(fit)
plot(fit)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
#fit<-mgcss(Y,s,grp=grp,t=t)
#summary(fit)
fit<-gcss(Y[7:12,],grp=grp,t=t)
plot(fit)
fit<-gcss(Y[13:17,],grp=grp,t=t)
fit<-gcss(Y[13:18,],grp=grp,t=t)
plot(fit)
library(CubicSmoothingSplines)
sellu<-read.table("../Data/sellu2.dat",header=FALSE)
colnames(sellu)<-c("nro","puul", "era", "visc", "bright", "elcond", "ph",
"b0", "b5", "b15", "b30", "b45", "b60",
"s0", "s5", "s15", "s30", "s45", "s60",
"t0", "t5", "t15", "t30", "t45", "t60",
"te0", "te5", "te15", "te30", "te45", "te60")
sellu<-sellu[sellu$puul==1,]
sellu<-sellu[-(15:16),]
Y<-sellu[,8:31]
Y<-as.matrix(Y)
Y<-t(Y)
dim(Y)
n<-ncol(Y)
s<-4
q<-6
t<-c(0,5,15,30,45,60)
grp<-rep(1,n)
grp[sellu$elcond>1.3]<-2
#fit<-mgcss(Y,s,grp=grp,t=t)
#summary(fit)
fit<-gcss(Y[13:18,],grp=grp,t=t)
plot(fit)
plot(fit)
fit<-gcss(Y[13:18,],grp=grp,t=t)
fit$alpha
fit$c
fit$alpha
